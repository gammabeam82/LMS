{% extends 'base.html.twig' %}

{% block title %}{{ 'messages.title' | trans }}{% endblock %}

{% block stylesheets %}
	{{ parent() }}
	<link rel="stylesheet" href="{{ asset('assets/vendor/jqcloud2/dist/jqcloud.min.css') }}"/>
{% endblock %}

{% block body %}

<div class="container-fluid">

	<div class="row margin-top-10">

		<div class="col-xs-4">
			<h3>{{ 'messages.recent_news' | trans }}</h3>
			<hr/>
		</div>

		{% if is_granted('IS_AUTHENTICATED_FULLY') %}

			<div class="col-xs-4">
				{% if books | length > 0 %}
					<h3>{{ 'messages.recent_books' | trans }}</h3>
					<hr/>
					<dl>
						{% for book in books %}
							{% if loop.index < 6 %}
								<dt>
									<a href="{{ path('books_view', { 'id': book.id }) }}">
										{{ book.name }}
									</a>
								</dt>
								<dd>
							<span class="text-muted">
								<i class="glyphicon glyphicon-time"></i>
								{{ book.createdAt | date('d.m.Y H:i') }}
							</span>
									{{ book.author.shortName }}
								</dd>
							{% endif %}
						{% endfor %}
					</dl>
				{% endif %}
			</div>

			<div class="col-xs-4">
				{% if comments | length > 0 %}
					<h3>{{ 'messages.recent_comments' | trans }}</h3>
					<hr/>
					<dl>
						{% for comment in comments %}
							<dt>
								{{ comment.user }}
							</dt>
							<dd class="comment">
								<span class="text-muted">
									<i class="glyphicon glyphicon-time"></i>
									{{ comment.postedAt | date('d.m.Y H:i:s') }}
								</span>
								|
								<a href="{{ path('books_view', { 'id': comment.book.id }) }}#c{{ comment.id }}">
									{{ comment.book.name }}
								</a>
								<br/>
								{{ comment.message }}
								<br/>
							</dd>
						{% endfor %}
					</dl>
				{% endif %}
			</div>

		{% endif %}

	</div>

	{#<div class="row">
		<div class="col-xs-12 margin-top-10 cloud"></div>
	</div>#}

</div>

{% endblock %}

{#{% block javascripts %}
	{{ parent() }}

	<script>
		const data = [
			{% for book in books %}
				{ text: '{{ book.name }}', weight: {{ book.views }}, link: '{{ path('books_view', { 'id': book.id }) }}' }
			{% if not loop.last %},{% endif %}
			{% endfor %}
		]
	</script>

	<script src="{{ asset('assets/vendor/jqcloud2/dist/jqcloud.min.js') }}"></script>
	<script src="{{ asset('assets/js/default-index.js') }}"></script>
{% endblock %}#}